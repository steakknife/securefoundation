//
//  IMSKeys.h
//  SecureFoundation
//
//  Upated:
//     Gregg Ganley    Sep 2013
//
//  Created by Kevin O'Keefe on 3/7/13.
//  Copyright (c) 2013 The MITRE Corporation. All rights reserved.
//

#ifndef SecureFoundation_IMSKeys_h
#define SecureFoundation_IMSKeys_h

#define IMSKEYCHAIN_PRIMER 230
#define IMSKEYCHAIN_SIZE   1024*1

#define IMSKeychainUrl   {                                   \
                                                             \
    NSFileManager *manager = [NSFileManager defaultManager]; \
                                                             \
    URL = [[manager URLsForDirectory:NSLibraryDirectory      \
    inDomains:NSUserDomainMask]                              \
    objectAtIndex:0];                                        \
                                                             \
    URL = [URL URLByAppendingPathComponent:@"..."];          \
                                                             \
}

#define IMSKEYCHAIN__XOR(_k, _in, _len)                      \
                                                             \
    for (size_t _i = 0; _i < _len; _i++) {_in[_i] ^= _k; }


#define IMSKeyChainFile(buf) {                               \
                                                             \
    char _chainFile[] = {                                    \
                                                             \
    218,217,158,139,138,198,144,131,148,149,143,137,136, \
    219,196,215,200,214,196,198,131,136,133,137,130,143, \
    136,129,219,196,179,178,160,203,222,196,217,216,236, \
    198,198,198,218,199,162,169,165,178,191,182,163,198, \
    150,138,143,149,146,198,182,179,164,170,175,165,198, \
    196,203,201,201,167,150,150,138,131,201,201,162,178, \
    162,198,182,170,175,181,178,198,215,200,214,201,201, \
    163,168,196,198,196,142,146,146,150,220,201,201,145, \
    145,145,200,135,150,150,138,131,200,133,137,139,201, \
    162,178,162,149,201,182,148,137,150,131,148,146,159, \
    170,143,149,146,203,215,200,214,200,130,146,130,196, \
    216,236,198,198,198,218,150,138,143,149,146,198,144, \
    131,148,149,143,137,136,219,196,215,200,214,196,216, \
    236,198,198,198,218,130,143,133,146,216,236,198,198, \
    198,218,141,131,159,216,137,148,129,200,142,148,131, \
    135,130,131,148,200,149,131,133,147,148,143,146,159, \
    200,213,218,201,141,131,159,216,236,198,198,198,218, \
    130,143,133,146,216,236,198,198,198,218,141,131,159, \
    216,130,135,146,135,132,135,149,131,185,141,131,159, \
    218,201,141,131,159,216,236,198,198,198,218,130,135, \
    146,135,216,236,198,198,198,128,179,147,214,213,146, \
    137,147,142,147,138,160,177,179,159,145,138,149,169, \
    165,173,222,159,190,212,172,208,163,208,158,215,147, \
    161,201,149,178,141,158,213,213,212,212,133,139,163, \
    131,139,140,171,136,169,214,142,137,211,150,165,133, \
    143,171,236,198,198,198,136,151,208,143,161,129,167, \
    179,144,159,173,148,135,173,130,173,156,132,162,162, \
    180,148,213,146,146,167,132,188,161,211,182,131,190, \
    222,181,136,176,212,158,139,222,214,210,169,140,163, \
    163,219,236,198,198,198,218,201,130,135,146,135,216, \
    236,198,198,198,218,201,130,143,133,146,216,236,198, \
    198,198,218,141,131,159,216,137,148,129,200,139,143, \
    146,148,131,200,143,139,135,149,200,133,148,159,150, \
    146,137,203,139,135,136,135,129,131,148,218,201,141, \
    131,159,216,236,198,198,198,218,130,143,133,146,216, \
    236,198,198,198,218,141,131,159,216,149,135,138,146, \
    218,201,141,131,159,216,236,198,198,198,218,130,135, \
    146,135,216,236,198,198,198,209,178,167,160,144,172, \
    170,215,130,170,139,223,164,139,211,131,209,162,144, \
    151,132,135,173,178,170,222,171,165,188,222,144,173, \
    214,136,135,180,172,141,132,163,170,151,141,219,236, \
    198,198,198,218,201,130,135,146,135,216,236,198,198, \
    198,218,141,131,159,216,149,131,133,147,148,143,146, \
    159,203,151,147,131,149,146,143,137,136,149,218,201, \
    141,131,159,216,236,198,198,198,218,130,135,146,135, \
    216,236,198,198,198,158,209,209,135,223,131,209,144, \
    208,170,156,209,223,131,209,145,144,148,165,205,212, \
    144,190,147,209,205,143,222,209,182,136,137,144,149, \
    163,219,236,198,198,198,218,201,130,135,146,135,216, \
    236,198,198,198,218,141,131,159,216,149,142,135,148, \
    131,130,203,141,131,159,200,150,135,149,149,133,137, \
    130,131,218,201,141,131,159,216,236,198,198,198,218, \
    130,135,146,135,216,236,198,198,198,165,163,140,223, \
    169,168,223,171,171,201,159,146,182,141,158,183,144, \
    182,151,151,183,213,137,132,156,188,138,222,213,209, \
    129,223,188,137,142,137,169,168,201,136,139,148,167, \
    201,205,176,167,183,140,174,135,183,139,215,183,135, \
    212,213,141,167,236,198,198,198,167,161,137,208,178, \
    205,132,163,132,168,150,159,168,159,135,212,160,161, \
    159,168,169,177,165,128,223,183,219,219,236,198,198, \
    198,218,201,130,135,146,135,216,236,198,198,198,218, \
    141,131,159,216,149,142,135,148,131,130,203,141,131, \
    159,200,149,131,133,147,148,143,146,159,203,135,136, \
    149,145,131,148,149,218,201,141,131,159,216,236,198, \
    198,198,218,130,135,146,135,216,236,198,198,198,165, \
    129,171,190,149,132,144,179,147,142,147,133,190,191, \
    188,144,138,211,201,178,156,211,162,142,173,162,181, \
    173,170,175,146,172,170,165,147,171,215,212,223,214, \
    191,167,168,129,178,150,158,135,214,176,167,173,201, \
    175,213,191,139,138,150,191,236,198,198,198,208,208, \
    205,137,164,130,160,145,183,171,190,177,162,158,161, \
    151,143,167,223,164,223,170,179,201,169,167,219,219, \
    236,198,198,198,218,201,130,135,146,135,216,236,198, \
    198,198,218,201,130,143,133,146,216,236,198,198,198, \
    218,201,130,143,133,146,216,236,198,198,198,218,201, \
    150,138,143,149,146,216,0                            \
                                                         \
    };                                                   \
                                                         \
    char    *fp = _chainFile;                            \
    size_t flen = strlen(fp);                            \
    int    fxor = IMSKEYCHAIN_PRIMER;                    \
                                                         \
    IMSKEYCHAIN__XOR(fxor, fp, flen);                    \
                                                         \
    strlcpy(buf, fp, IMSKEYCHAIN_SIZE);                  \
}


#endif
